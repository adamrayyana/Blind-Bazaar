{% extends 'base.html' %}
{% load static %}

{% block title %}Blind Bazaar{% endblock title %}

{% block extra_head %}
  <script src="{% static 'js/products.js' %}" defer></script>
{% endblock extra_head %}

{% block content %}
{% include 'navbar.html' %}

<main
  id="product-page-root"
  class="min-h-screen pt-24 pb-16 bg-gradient-to-b from-blue-50 via-white to-white"
  data-products-endpoint="{% url 'main:products_collection' %}"
  data-product-resource-template="{% url 'main:product_resource' '00000000-0000-0000-0000-000000000000' %}"
  data-product-detail-template="{% url 'main:product_detail' '00000000-0000-0000-0000-000000000000' %}"
  data-placeholder-image="{% static 'images/no_image.jpeg' %}"
>
  <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 space-y-12">
    <section class="rounded-3xl bg-blue-600 text-white shadow-lg">
      <div class="px-8 py-10 sm:px-12 sm:py-14">
        <div class="flex flex-col gap-8 lg:flex-row lg:items-center lg:justify-between">
          <div>
            <h1 class="text-3xl sm:text-4xl font-bold leading-tight">Blind Bazaar</h1>
            <p class="mt-3 max-w-2xl text-base sm:text-lg text-white/80">
              Improve your football match with cards and other power-ups!
            </p>
            <div class="mt-6 flex flex-wrap items-center gap-4">
              <button
                id="product-create-button"
                class="inline-flex items-center gap-2 rounded-full bg-white px-5 py-3 text-sm font-semibold text-blue-700 transition hover:-translate-y-0.5 hover:bg-blue-50"
                type="button"
                onclick="showModal()"
              >
                <span class="text-lg leading-none">+</span>
                <span>Add Product</span>
              </button>
            </div>
          </div>
          <div class="flex flex-wrap gap-2 text-xs font-medium text-blue-900">
            <span class="px-3 py-1 rounded-full border border-blue-200 bg-blue-50 text-blue-700">Name: {{ name }}</span>
            <span class="px-3 py-1 rounded-full border border-blue-200 bg-blue-50 text-blue-700">NPM: {{ npm }}</span>
            <span class="px-3 py-1 rounded-full border border-blue-200 bg-blue-50 text-blue-700">Class: {{ class }}</span>
            <span class="px-3 py-1 rounded-full border border-blue-200 bg-blue-50 text-blue-700">Last login: {{ last_login }}</span>
          </div>
        </div>
      </div>
    </section>

    <section aria-labelledby="product-controls" class="space-y-6 rounded-3xl border border-blue-100 bg-white/90 p-6 sm:p-8 shadow-sm backdrop-blur">
      <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
        <div class="flex flex-wrap items-center gap-3">
          <button
            class="filter-chip active"
            type="button"
            data-filter="all"
          >
            All Products
          </button>
          <button
            class="filter-chip"
            type="button"
            data-filter="my"
          >
            My Products
          </button>
        </div>
        <div class="flex flex-wrap items-center gap-3">
          <button
            id="product-refresh-button"
            type="button"
            class="inline-flex items-center gap-2 rounded-full border border-blue-200 px-4 py-2 text-sm font-semibold text-blue-700 transition hover:bg-blue-50"
          >
            <span class="inline-block h-2 w-2 rounded-full bg-blue-500 animate-ping"></span>
            Refresh
          </button>
          <p class="text-xs text-gray-500">Tip: refresh to see the latest items in the catalogue.</p>
        </div>
      </div>

      <div id="product-loading" class="rounded-2xl border border-blue-100 bg-blue-50/70 p-10 text-center text-blue-700">
        <svg class="mx-auto h-10 w-10 animate-spin text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
        </svg>
        <p class="mt-4 text-sm font-semibold">Loading products...</p>
      </div>

      <div id="product-error" class="hidden rounded-2xl border border-rose-100 bg-rose-50 p-10 text-center text-rose-600">
        <h3 class="text-lg font-semibold">Unable to load products</h3>
        <p class="mt-2 text-sm">Please refresh the page or try again in a moment.</p>
        <button
          type="button"
          class="mt-4 inline-flex items-center gap-2 rounded-full bg-rose-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-rose-700"
          data-action="retry"
        >
          Retry now
        </button>
      </div>

      <div id="product-empty" class="hidden rounded-2xl border border-dashed border-blue-200 bg-white p-12 text-center">
        <img src="{% static 'images/no_products.png' %}" alt="no products " class="w-64 h-64 mx-auto object-contain">
        <h3 class="mt-6 text-lg font-semibold text-gray-800">No products here!</h3>
        <p class="mt-2 text-sm text-gray-500">Add them plssssss</p>
      </div>

      <div id="product-grid" class="hidden grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3"></div>
    </section>
  </div>
</main>

{% endblock content %}
